<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content=""What I cannot create, I do not understand."   -Richard P. Feynman-">
	<meta property="og:title" content="Breast Cancer Prediction" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://localhost:4000///2017/09/12/breast_cancer_prediction/" />
<meta property="og:image" content="http://localhost:4000//img/home-bg.jpg">
	
	

	<meta name="citation_title" content="Project Pages - An Integrated Scientific Blogging Template">


<meta name="citation_author" content="Ahmet Cecen">


<meta name="citation_author" content="David Brough">


<meta name="citation_author" content="Surya R. Kalidindi">



	
	<link rel='shortcut icon' type='image/png' href='/favi.png' />

    <title>Breast Cancer Prediction - SUNGHO KIM</title>

    <link rel="canonical" href="http://localhost:4000/2017/09/12/breast_cancer_prediction/">
	
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="http://localhost:4000/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="http://localhost:4000/css/clean-blog.css">
	
	<!-- Adjust Colors -->
    <link rel="stylesheet" href="http://localhost:4000/colorscheme.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="http://localhost:4000/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<!-- Math Jax -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script type="text/javascript"
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		TeX: { equationNumbers: { autoNumber: "AMS" } }
	});
	</script>

	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
	<script src="http://localhost:4000/js/clean-blog.min.js "></script>
	
	
<!-- Asynchronous Google Analytics snippet -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106398465-1', 'auto');
  ga('send', 'pageview');

</script>

	
</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">SUNGHO KIM</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
				
                
                <li>
                    <a href="/about/">About</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/home-bg.jpg');">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading" style="padding: 30px 0">
                    <h1>Breast Cancer Prediction</h1>
<!--                     
                    <h2 class="subheading">Using Machine Learning Classfiers (Random Forrest & SVM)</h2>
                    
                    <span class="meta">Posted by Sungho Kim on September 12, 2017</span>	 -->
                </div>
            </div>
        </div>
    </div>
</header>






	
	
		
	

<!-- Also Interesting -->



	
	
	

	
	 
	
	
	

	
	 
	
	
	

	
	 
	
	
	

	
	 
	
	
	


		</div>
		</div>

<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>

<article>
    <div id="content" class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p><img src="/img/post/breast_cancer/title.png" alt="&quot;Des&quot;" /></p>

<p>Machine Learning Algorithms can be applied in many different areas. Not just in Netflix’s movie or Spotify’s music recommender engines, but also in the areas where have big and complicated data. Healthcare Industry is also where big data exist and have many problems to solve. Big companies like IBM(Watson) and Google(DeepMind) have already started applying and developing and machine learning healthcare applications. Besides them, there are also many young healthcare startups that use machine learning, such as Ayasdi, Nervanasys, Sentient.ai, and Reasoning Systems.</p>

<p>Some currently on going Machine Learning Healthcare Applications by the companies are Diagnosis in Medical Imaging, Drug discover, Robotic Surgery, Treatment Queries and Suggestions so on.</p>

<p>In this post, I am going to use two of Machine Learning Classifiers (Random Forrest &amp; SVM) to build a simple model that can predict whether the patient’s cancer is benign or malignant. And I am going to use the Breast Cancer Wisconsin dataset.(Diagnostic)</p>

<p><strong>PREPARE DATA</strong></p>

<p>Load the data first, and see what it looks like. As you can see it from the picture, the data type of target value that we want to predict “diagnosis” is not integer, but categorical values “Malignant” and “Benign”. I changed them into the numbers “1” and “0” respectively. After that, I dropped any column with more than 50% missing values.</p>

<pre style="color:#d1d1d1;background:#000000;">data <span style="color:#d2cd86; ">=</span> pd<span style="color:#d2cd86; ">.</span>read_csv<span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">"breast_cancer.csv"</span><span style="color:#d2cd86; ">)</span>
<span style="color:#e66170; font-weight:bold; ">print</span><span style="color:#d2cd86; ">(</span>data<span style="color:#d2cd86; ">.</span>head<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>
<span style="color:#e66170; font-weight:bold; ">print</span><span style="color:#d2cd86; ">(</span>data<span style="color:#d2cd86; ">.</span>info<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>
data<span style="color:#d2cd86; ">[</span><span style="color:#00c4c4; ">'diagnosis'</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">=</span>data<span style="color:#d2cd86; ">[</span><span style="color:#00c4c4; ">'diagnosis'</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">.</span><span style="color:#e66170; font-weight:bold; ">map</span><span style="color:#d2cd86; ">(</span><span style="color:#b060b0; ">{</span><span style="color:#00c4c4; ">'M'</span><span style="color:#d2cd86; ">:</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span><span style="color:#00c4c4; ">'B'</span><span style="color:#d2cd86; ">:</span><span style="color:#00a800; ">0</span><span style="color:#b060b0; ">}</span><span style="color:#d2cd86; ">)</span>  
half_count <span style="color:#d2cd86; ">=</span> <span style="color:#e66170; font-weight:bold; ">len</span><span style="color:#d2cd86; ">(</span>data<span style="color:#d2cd86; ">)</span> <span style="color:#00dddd; ">/</span> <span style="color:#00a800; ">2</span>
data <span style="color:#d2cd86; ">=</span> data<span style="color:#d2cd86; ">.</span>dropna<span style="color:#d2cd86; ">(</span>thresh<span style="color:#d2cd86; ">=</span>half_count<span style="color:#d2cd86; ">,</span>axis<span style="color:#d2cd86; ">=</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">)</span>
</pre>

<p><img src="/img/post/breast_cancer/1.png" alt="&quot;Des&quot;" /></p>

<p>Before I started building a model, I was curious about the distribution of the target Malignant and Benign. So I used the following command to visualize them. If you don’t want to plot them and just see the numbers, you can just type <strong>print(data[‘diagnosis’].value_counts())</strong>.</p>

<pre style="color:#d1d1d1;background:#000000;">sns<span style="color:#d2cd86; ">.</span>countplot<span style="color:#d2cd86; ">(</span>data<span style="color:#d2cd86; ">[</span><span style="color:#00c4c4; ">'diagnosis'</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span>label<span style="color:#d2cd86; ">=</span><span style="color:#00c4c4; ">"Count"</span><span style="color:#d2cd86; ">)</span>
plt<span style="color:#d2cd86; ">.</span>show<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span>
</pre>
<p><img src="/img/post/breast_cancer/2.png" alt="&quot;Des&quot;" /></p>

<p><strong>FEATURE SELECTION</strong></p>

<p>Before the feature selection, I decided to visualize the correlation between the target and features. It looks like most of the features are positively related with the target, but I decided to select the features that have correlation values with target(“diagnosis)” from 0.55 to 1.</p>

<pre style="color:#d1d1d1;background:#000000;">data_corr <span style="color:#d2cd86; ">=</span> data<span style="color:#d2cd86; ">.</span>corr<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span>
data_corr<span style="color:#d2cd86; ">[</span><span style="color:#00c4c4; ">'diagnosis'</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">.</span>sort_values<span style="color:#d2cd86; ">(</span>ascending<span style="color:#d2cd86; ">=</span>False<span style="color:#d2cd86; ">)</span>
data_corr<span style="color:#d2cd86; ">[</span><span style="color:#00c4c4; ">'diagnosis'</span><span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">.</span>sort_values<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">.</span>plot<span style="color:#d2cd86; ">(</span>kind<span style="color:#d2cd86; ">=</span><span style="color:#00c4c4; ">'bar'</span><span style="color:#d2cd86; ">,</span>sort_columns<span style="color:#d2cd86; ">=</span>True<span style="color:#d2cd86; ">)</span>
plt<span style="color:#d2cd86; ">.</span>show<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span>
</pre>
<p><img src="/img/post/breast_cancer/4.png" alt="&quot;Des&quot;" /></p>

<p>If you want to include more features, it is up to you. After the feature selection, I ran a command that draws a heat map of the correlation between target and selected features.</p>

<pre style="color:#d1d1d1;background:#000000;">fig<span style="color:#d2cd86; ">=</span>plt<span style="color:#d2cd86; ">.</span>figure<span style="color:#d2cd86; ">(</span>figsize<span style="color:#d2cd86; ">=</span><span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">12</span><span style="color:#d2cd86; ">,</span><span style="color:#00a800; ">18</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>
selected_features_corr <span style="color:#d2cd86; ">=</span> data<span style="color:#d2cd86; ">[</span>selected_features<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">.</span>corr<span style="color:#d2cd86; ">(</span><span style="color:#d2cd86; ">)</span>
sns<span style="color:#d2cd86; ">.</span>heatmap<span style="color:#d2cd86; ">(</span>selected_features_corr<span style="color:#d2cd86; ">,</span> cbar <span style="color:#d2cd86; ">=</span> True<span style="color:#d2cd86; ">,</span>  square <span style="color:#d2cd86; ">=</span> True<span style="color:#d2cd86; ">,</span> annot<span style="color:#d2cd86; ">=</span>True<span style="color:#d2cd86; ">,</span> fmt<span style="color:#d2cd86; ">=</span> <span style="color:#00c4c4; ">'.2f'</span><span style="color:#d2cd86; ">,</span>annot_kws<span style="color:#d2cd86; ">=</span><span style="color:#b060b0; ">{</span><span style="color:#00c4c4; ">'size'</span><span style="color:#d2cd86; ">:</span> <span style="color:#00a800; ">8</span><span style="color:#b060b0; ">}</span><span style="color:#d2cd86; ">,</span>
           xticklabels<span style="color:#d2cd86; ">=</span> selected_features<span style="color:#d2cd86; ">,</span> yticklabels<span style="color:#d2cd86; ">=</span> selected_features<span style="color:#d2cd86; ">,</span> cmap<span style="color:#d2cd86; ">=</span> <span style="color:#00c4c4; ">'coolwarm'</span><span style="color:#d2cd86; ">)</span>
</pre>
<p><img src="/img/post/breast_cancer/5.png" alt="&quot;Des&quot;" /></p>

<p><strong>SPLIT DATA</strong></p>
<pre style="color:#d1d1d1;background:#000000;">Y_data <span style="color:#d2cd86; ">=</span> data<span style="color:#d2cd86; ">[</span><span style="color:#00c4c4; ">'diagnosis'</span><span style="color:#d2cd86; ">]</span>
X_data <span style="color:#d2cd86; ">=</span> data<span style="color:#d2cd86; ">[</span>selected_features<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">.</span>iloc<span style="color:#d2cd86; ">[</span><span style="color:#d2cd86; ">:</span><span style="color:#d2cd86; ">,</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">:</span><span style="color:#d2cd86; ">]</span>
<span style="color:#9999a9; ">#print(X_data.columns.values)</span>
X_train<span style="color:#d2cd86; ">,</span>X_test<span style="color:#d2cd86; ">,</span>Y_train<span style="color:#d2cd86; ">,</span>Y_test <span style="color:#d2cd86; ">=</span> train_test_split<span style="color:#d2cd86; ">(</span>X_data<span style="color:#d2cd86; ">,</span>Y_data<span style="color:#d2cd86; ">,</span>random_state<span style="color:#d2cd86; ">=</span><span style="color:#00a800; ">0</span><span style="color:#d2cd86; ">,</span>stratify<span style="color:#d2cd86; ">=</span>Y_data<span style="color:#d2cd86; ">)</span> 
<span style="color:#9999a9; "># print(Y_train.shape, Y_test.shape)</span>
</pre>

<p><strong>RANDOM FORREST &amp; SVM</strong></p>

<p>Both models performed really well given the size of the dataset. I got Random Forrest model with an accuracy score of 0.951 and SVM model with an accuracy score of 0.965.</p>

<p>It looks like overfitting occurred in Random Forrest model, because it performed really well on training set, but poorly on test set. I tried to solve overfitting by tuning the hyperparameters of the model.</p>

<pre style="color:#d1d1d1;background:#000000;">clf<span style="color:#d2cd86; ">=</span>RandomForestClassifier<span style="color:#d2cd86; ">(</span>n_estimators<span style="color:#d2cd86; ">=</span><span style="color:#00a800; ">100</span><span style="color:#d2cd86; ">,</span>random_state <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">42</span><span style="color:#d2cd86; ">)</span>
clf<span style="color:#d2cd86; ">.</span>fit<span style="color:#d2cd86; ">(</span>X_train<span style="color:#d2cd86; ">,</span>Y_train<span style="color:#d2cd86; ">)</span>
<span style="color:#e66170; font-weight:bold; ">print</span><span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">'Random Forrest Accuracy on the Training subset:{:.3f}'</span><span style="color:#d2cd86; ">.</span>format<span style="color:#d2cd86; ">(</span>clf<span style="color:#d2cd86; ">.</span>score<span style="color:#d2cd86; ">(</span>X_train<span style="color:#d2cd86; ">,</span>Y_train<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>
<span style="color:#e66170; font-weight:bold; ">print</span><span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">'Random Forrest Accuracy on the Test subset:{:.3f}'</span><span style="color:#d2cd86; ">.</span>format<span style="color:#d2cd86; ">(</span>clf<span style="color:#d2cd86; ">.</span>score<span style="color:#d2cd86; ">(</span>X_test<span style="color:#d2cd86; ">,</span>Y_test<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>

svc <span style="color:#d2cd86; ">=</span> svm<span style="color:#d2cd86; ">.</span>SVC<span style="color:#d2cd86; ">(</span>kernel<span style="color:#d2cd86; ">=</span><span style="color:#00c4c4; ">'linear'</span><span style="color:#d2cd86; ">)</span>
svc<span style="color:#d2cd86; ">.</span>fit<span style="color:#d2cd86; ">(</span>X_train<span style="color:#d2cd86; ">,</span> Y_train<span style="color:#d2cd86; ">)</span>    
<span style="color:#e66170; font-weight:bold; ">print</span><span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">'SVM Accuracy on the Training subset:{:.3f}'</span><span style="color:#d2cd86; ">.</span>format<span style="color:#d2cd86; ">(</span>svc<span style="color:#d2cd86; ">.</span>score<span style="color:#d2cd86; ">(</span>X_train<span style="color:#d2cd86; ">,</span>Y_train<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>
<span style="color:#e66170; font-weight:bold; ">print</span><span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">'SVM Accuracy on the Test subset:{:.3f}'</span><span style="color:#d2cd86; ">.</span>format<span style="color:#d2cd86; ">(</span>svc<span style="color:#d2cd86; ">.</span>score<span style="color:#d2cd86; ">(</span>X_test<span style="color:#d2cd86; ">,</span>Y_test<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>
</pre>
<p><img src="/img/post/breast_cancer/accuracy.png" alt="&quot;Des&quot;" /></p>

<p><strong>Hyperparameter Optimization</strong></p>

<p>I used RandomSearchCV to optimize the hyperparameters. Now I got Random Forrest model with an accuracy score of 0.965. The model improved by 0.014 after the hyperparmeter optimization.</p>

<pre style="color:#d1d1d1;background:#000000;">rf_clf<span style="color:#d2cd86; ">=</span>RandomForestClassifier<span style="color:#d2cd86; ">(</span>random_state <span style="color:#d2cd86; ">=</span> <span style="color:#00a800; ">42</span><span style="color:#d2cd86; ">)</span>
param_grid <span style="color:#d2cd86; ">=</span> <span style="color:#b060b0; ">{</span><span style="color:#00c4c4; ">"max_depth"</span><span style="color:#d2cd86; ">:</span> <span style="color:#d2cd86; ">[</span><span style="color:#00a800; ">3</span><span style="color:#d2cd86; ">,</span> None<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span>
              <span style="color:#00c4c4; ">"max_features"</span><span style="color:#d2cd86; ">:</span>  sp_randint<span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">8</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span>
              <span style="color:#00c4c4; ">"min_samples_split"</span><span style="color:#d2cd86; ">:</span> sp_randint<span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">2</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">11</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span>
              <span style="color:#00c4c4; ">"min_samples_leaf"</span><span style="color:#d2cd86; ">:</span> sp_randint<span style="color:#d2cd86; ">(</span><span style="color:#00a800; ">1</span><span style="color:#d2cd86; ">,</span> <span style="color:#00a800; ">11</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">,</span>
              <span style="color:#00c4c4; ">"bootstrap"</span><span style="color:#d2cd86; ">:</span> <span style="color:#d2cd86; ">[</span>True<span style="color:#d2cd86; ">,</span> False<span style="color:#d2cd86; ">]</span><span style="color:#d2cd86; ">,</span>
              <span style="color:#00c4c4; ">"criterion"</span><span style="color:#d2cd86; ">:</span> <span style="color:#d2cd86; ">[</span><span style="color:#00c4c4; ">"gini"</span><span style="color:#d2cd86; ">,</span> <span style="color:#00c4c4; ">"entropy"</span><span style="color:#d2cd86; ">]</span><span style="color:#b060b0; ">}</span>
rand_rf <span style="color:#d2cd86; ">=</span> RandomizedSearchCV<span style="color:#d2cd86; ">(</span>rf_clf<span style="color:#d2cd86; ">,</span> param_distributions<span style="color:#d2cd86; ">=</span>param_grid<span style="color:#d2cd86; ">,</span> n_iter<span style="color:#d2cd86; ">=</span><span style="color:#00a800; ">100</span><span style="color:#d2cd86; ">,</span> random_state<span style="color:#d2cd86; ">=</span><span style="color:#00a800; ">42</span><span style="color:#d2cd86; ">)</span>
rand_rf<span style="color:#d2cd86; ">.</span>fit<span style="color:#d2cd86; ">(</span>X_train<span style="color:#d2cd86; ">,</span>Y_train<span style="color:#d2cd86; ">)</span>
<span style="color:#e66170; font-weight:bold; ">print</span><span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">'Random Forrest Accuracy on the Training subset:{:.3f}'</span><span style="color:#d2cd86; ">.</span>format<span style="color:#d2cd86; ">(</span>rand_rf<span style="color:#d2cd86; ">.</span>score<span style="color:#d2cd86; ">(</span>X_train<span style="color:#d2cd86; ">,</span>Y_train<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>
<span style="color:#e66170; font-weight:bold; ">print</span><span style="color:#d2cd86; ">(</span><span style="color:#00c4c4; ">'Random Forrest Accuracy on the Test subset:{:.3f}'</span><span style="color:#d2cd86; ">.</span>format<span style="color:#d2cd86; ">(</span>rand_rf<span style="color:#d2cd86; ">.</span>score<span style="color:#d2cd86; ">(</span>X_test<span style="color:#d2cd86; ">,</span>Y_test<span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span><span style="color:#d2cd86; ">)</span>
</pre>
<p><img src="/img/post/breast_cancer/final.png" alt="&quot;Des&quot;" /></p>

<p>I hope you enjoyed this post, and please let me know if you have any questions, or feedback. You can reach me on <a href="https://www.linkedin.com/in/sunghok/">Linkedin</a> or email me at <a href="mailto:sunghokim@wustl.edu?Subject=Hello%20again" target="_top">sunghokim@wustl.edu</a>.</p>



                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/09/05/spotify/" data-toggle="tooltip" data-placement="top" title="Let me find your Spotify music">&larr; Previous Post</a>
                    </li>
                    
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>

<!-- <div class="container" style="padding-right: 50px;padding-left: 50px;">
<div class="row">
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1" id="disqus_thread">

</div>
</div>
</div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = '';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
 -->

<hr>


	
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/sunghok/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
									
                </ul>
                <p class="copyright text-muted"> Copyright © <a href="http://ahmetcecen.github.io/" target="_blank">Ahmet Cecen</a>,  <a href="http://mined.gatech.edu/" target="_blank">MINED@GaTech</a> and <a href="https://github.com/projectpages" target="_blank">Project Pages</a> 2016. </p>
            </div>
        </div>
    </div>
</footer>



    
</body>

</html>
